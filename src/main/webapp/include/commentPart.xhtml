<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:a4j="http://richfaces.org/a4j"
                 xmlns:cc="http://java.sun.com/jsf/composite">

    <h:form rendered="#{identity.loggedIn}">
        <rich:panel header="Add comment" style="max-width: 400px;" >
            <h:inputHidden value="#{commentManager.contentId}"/>
            <h:panelGrid columns="1">
                <h:inputTextarea id="desc" value="#{commentManager.currentComment.description}" style="width: 350px" rows="5"/>
                <a4j:commandButton action="#{commentManager.addComment}" execute="@form" value="Send" render="commentsGrid,desc"/>
            </h:panelGrid>
        </rich:panel>
    </h:form>
    <h:form>
        <rich:dataGrid id="commentsGrid" value="#{commentManager.comments}" var="comment" columns="1"
                       elements="9" width="400px" border="0">
            <h:panelGrid columns="2" width="400px">
                <h:graphicImage value="#{contentManager.getCoverUrl('rc48x48.jpg')}" />
                <h:panelGroup>
                    <h:panelGrid columns="2" width="100%">
                        <h:link id="viewUser" value="#{comment.author.name}" outcome="user" style="white-space: nowrap;">
                            <f:param name="id" value="#{comment.author.username}"/>
                        </h:link>
                        <h:outputText value="#{comment.createDateTime}" >
                            <f:convertDateTime pattern="dd.MM.yy HH:mm" />
                        </h:outputText>
                    </h:panelGrid>

                    <h:outputText value="#{comment.description}"></h:outputText>
                </h:panelGroup>

            </h:panelGrid>
        </rich:dataGrid>
        <rich:dataScroller for="commentsGrid" renderIfSinglePage="false" />
    </h:form>


</ui:composition>
