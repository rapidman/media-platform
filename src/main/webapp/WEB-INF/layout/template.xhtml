<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:pretty="http://ocpsoft.com/prettyfaces"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:f="http://java.sun.com/jsf/core">
<f:view>
    <ui:insert name="metadata"/>
    <h:head>
        <!-- Mimic Internet Explorer 8 -->
        <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8"  />

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>#{bundles.messages.template_title}</title>
        <link rel="shortcut icon" href="#{request.contextPath}/favicon.ico"/>
        <h:outputStylesheet library="css" name="media-platform.css" target="head" />
        <ui:insert name="head"/>
    </h:head>


    <h:body styleClass="#{empty pageClass ? 'page' : 'home'}">
        <div id="document" align="center" class="wrapper">
            <div id="header" align="right">
                <div id="title" >
                    <!--<h:graphicImage value="/img/hdr.title.gif" alt="JBoss Suites banner"/>-->
                </div>
                <h:form id="menuForm">
                    <rich:toolbar height="26px" itemSeparator="line">
                        <h:outputLink value="#" id="ll" rendered="#{not identity.loggedIn and facesContext.viewRoot.viewId != '/login.xhtml'}" >
                            <rich:componentControl event="click" operation="show" target="lp">
                                <a4j:param name="event" value="event" noEscape="true"/>
                                <rich:hashParam>
                                    <a4j:param noEscape="true" name="top"
                                               value="jQuery(#{rich:element('ll')}.parentNode).offset().top + jQuery(#{rich:element('ll')}.parentNode).height()"/>
                                    <a4j:param noEscape="true" name="left"
                                               value="jQuery(#{rich:element('ll')}.parentNode).offset().left"/>
                                </rich:hashParam>
                            </rich:componentControl>
                            Login
                        </h:outputLink>

                        <rich:toolbarGroup location="right" rendered="#{identity.loggedIn}">
                            <h:outputText value="(#{currentUser.name})"
                                          styleClass="user"/>
                        </rich:toolbarGroup>

                        <rich:toolbarGroup location="right">
                            <pretty:link mappingId="home">#{bundles.messages.template_linkHome}</pretty:link>
                        </rich:toolbarGroup>

                        <rich:toolbarGroup location="right" rendered="#{identity.loggedIn and identity.hasRole('admin', 'USERS', 'GROUP')}">
                            <h:commandLink rendered="#{facesContext.viewRoot.viewId != '/content/viewLiveStreamList.xhtml'}" action="#{liveStreamManager.show}">#{bundles.messages.template_live_streams}</h:commandLink>
                            <h:outputText rendered="#{facesContext.viewRoot.viewId == '/content/viewLiveStreamList.xhtml'}" value="#{bundles.messages.template_live_streams}"/>
                        </rich:toolbarGroup>

                        <rich:toolbarGroup location="right" rendered="#{identity.loggedIn}">
                            <pretty:link mappingId="account">#{bundles.messages.template_linkAccount}</pretty:link>
                        </rich:toolbarGroup>

                        <rich:toolbarGroup location="right" rendered="#{identity.loggedIn and identity.hasRole('admin', 'USERS', 'GROUP')}">
                            <h:commandLink rendered="#{facesContext.viewRoot.viewId != '/user/viewUserList.xhtml'}" action="#{userList.show}">#{bundles.messages.template_users}</h:commandLink>
                            <h:outputText rendered="#{facesContext.viewRoot.viewId == '/user/viewUserList.xhtml'}" value="#{bundles.messages.template_users}"/>
                        </rich:toolbarGroup>

                        <rich:toolbarGroup location="right" rendered="#{identity.loggedIn}">
                            <pretty:link mappingId="logout">#{bundles.messages.template_linkLogout}</pretty:link>
                        </rich:toolbarGroup>

                        <rich:toolbarGroup location="right" rendered="#{facesContext.application.projectStage == 'Development'}">
                            <h:commandLink action="pretty:home"
                                           actionListener="#{facesContext.externalContext.invalidateSession}"
                                           value="#{bundles.messages.template_linkReset}"/>
                        </rich:toolbarGroup>


                        <rich:toolbarGroup location="right">
                            <h:inputText styleClass="barsearch"/>
                            <h:commandButton styleClass="barsearchbutton" onclick="return false;" value="Search"/>
                        </rich:toolbarGroup>
                    </rich:toolbar>
                </h:form>
                <rich:popupPanel id="lp" autosized="true" modal="false" moveable="false" resizeable="false" followByScroll="false" rendered="#{not identity.loggedIn}">
                    <h:form>
                        <h:panelGrid columns="2">
                            <h:outputLabel for="username" value="#{bundles.messages.home_usernameLabel}" style="width: 70px; text-align: left"/>
                            <h:inputText id="username" value="#{credentials.username}" style="width: 120px;"/>

                            <h:outputLabel for="password" value="#{bundles.messages.home_passwordLabel}" style="width: 70px; text-align: left"/>
                            <h:inputSecret id="password" value="#{credentials.password}" style="width: 120px;"/>
                        </h:panelGrid>


                        <h:panelGrid columns="2">
                            <h:commandButton id="login" action="#{identity.login}" value="#{bundles.messages.home_loginAction}"/>
                            <input type="button" value="Cancel" onclick="#{rich:component('lp')}.hide(event); return false;"/>
                        </h:panelGrid>

                        <h:panelGrid columns="2">
                            <h:commandLink action="#{twitterBean.login}"><h:graphicImage url="/images/social/twitter_icon4.jpg" height="16" width="16"/></h:commandLink>
                            <h:commandLink action="#{facebookBean.login}"><h:graphicImage url="/images/social/facebookicon.png" height="16" width="16"/></h:commandLink>
                        </h:panelGrid>

                        <div align="center">
                            <div class="notes" align="left">
                                <h:link id="register" outcome="/register.xhtml"
                                        value="#{bundles.messages.home_registerAction}"/>
                            </div>

                            <div class="subnotes" align="left">
                                #{bundles.messages.home_useDemoAccount}
                                <ul>
                                    <li>admin/admin</li>
                                    <li>shane/brisbane</li>
                                </ul>
                            </div>
                        </div>
                    </h:form>
                </rich:popupPanel>
            </div>
            <div id="container" align="left">
                <table cellpadding="10px" width="100%" style="height: 100%">
                    <tr>
                        <td valign="top" height="100%">
                            <div id="sidebar"><ui:insert name="sidebar"/></div>
                        </td>
                        <td width="100%" valign="top">
                            <div align="left"><h:messages globalOnly="true" errorStyle="color: #a52a2a;"/></div>
                            <div id="content"><ui:insert name="content"/></div>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="push"></div>
        </div>
        <div id="footer" align="center" class="footer">
            Media Platform &copy;   <br/>
            #{bundles.messages.template_createdWith}<br/>
            #{bundles.messages.template_projectStage}: #{initParam['javax.faces.PROJECT_STAGE']}
            #{' | '}
            #{bundles.messages.template_currentConversation}:
            #{conversation.transient ? 'transient' : 'long-running, id: '.concat(conversation.id)}
        </div>

    </h:body>
</f:view>
</html>
